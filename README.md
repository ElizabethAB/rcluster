The purpose of this repository is to make cluster computing using RStudio Server on AWS simple and accessible.

This repository will:

* Create master and worker AMIs saved to your AWS registry
* Allow you to launch a master and a stated number of worker nodes, automating
  the network connections between them and hosting a common NFS-based home
  folder under the default `cluster:cluster-base-password` user:
    * /home/cluster is shared between master and all workers
    * /home/cluster/hostfile contains the IPs of accessible worker nodes and
      spare master nodes, repeated based on the number of available worker cores
    * `cluster` user's .Rprofile defines an R function (`defaultCluster()`)
      which will reference the hostfile to create a PSOCK-based cluster

After that, login to RStudio Server as normal on the master, run
`defaultCluster()`, and use the returned parallel cluster object with
`parLapply()` and its peers.

# Getting Started

First, you must take two steps through your AWS console:

* Save locally an [AWS access key and secret access key](http://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSGettingStartedGuide/AWSCredentials.html), and
* Create and save locally an [EC2 key pair](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html).
    
Next, "initial_setup.py" is an executable file. Run from your `rcluster`
repository folder, it will prompt you for your AWS access key, AWS secret access
key, and the filepath to your key (you can edit
"cluster-configs/basic_config.json" directly in lieu of following prompts). It
uses that information, plus the bare-bones configuration dictionary stored in
"cluster-configs/basic_config.json", to generate the AMI, security group, and
placement group for your cluster to your AWS registry.

Recommended edits to "instance-configs\ami.sh":
* Line 44: Replace `cluster-base-password` with a unique and secure password


Once "create_amis.py" has succesfully finished running, you should have
"cluster-configs/basic_private.json" saved in your repository. This stores your
access information and the IDs of the AMIs generated by "initial_setup.py"
(don't worry, any "*private*" files are ignored by your repository.)

You should now be able to call "rcluster.py" from the command line. It takes two
arguments, `--config` which indicates the JSON file to use (default to
"cluster-configs/basic_private.json") and `--workers` to indicate the number of
workers to generate (defaults to 1).
